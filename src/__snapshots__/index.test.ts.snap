// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`inlineChangesHighlighted commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                                                         
Author: Shrey Banga <shrey@quip.com>                                                                                    
Date:   Tue May 23 16:47:17 2017 -0700                                                                                  
                                                                                                                        
    sonos to brew                                                                                                       
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                                                            
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                                                        
   19    brew 'socat'                                          19    brew 'socat'                                       
                                                               20  + brew 'sonos'                                       
   20    brew 'terminal-notifier'                              21    brew 'terminal-notifier'                           
@@ -42,3 +43,2 @@ cask 'rescuetime'                                                                                     
   42    cask 'slate'                                          43    cask 'slate'                                       
   43  - cask 'sonos'                                                                                                   
   43    cask 'spotify'                                        44    cask 'spotify'                                     
"
`;

exports[`inlineChangesHighlighted commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                                                         
Author: Shrey Banga <shrey@quip.com>                                                                                    
Date:   Tue May 23 16:47:17 2017 -0700                                                                                  
                                                                                                                        
    sonos to brew                                                                                                       
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                                                            
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                                                        
   19    brew 'socat'                                          19    brew 'socat'                                       
                                                               20  + brew 'sonos'                                       
   20    brew 'terminal-notifier'                              21    brew 'terminal-notifier'                           
@@ -42,3 +43,2 @@ cask 'rescuetime'                                                                                     
   42    cask 'slate'                                          43    cask 'slate'                                       
   43  - cask 'sonos'                                                                                                   
   43    cask 'spotify'                                        44    cask 'spotify'                                     
"
`;

exports[`inlineChangesHighlighted commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 15:25:34 2021 -0700                                                                                  
                                                                                                                        
    Add theme support                                                                                                   
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                                                         
    9    -   [x] Organize code                                  9    -   [x] Organize code                              
                                                               10  + -   [x] Move visual config to theme                
   10    -   [ ] Handle empty diffs                            11    -   [ ] Handle empty diffs                         
   11                                                          12                                                       
"
`;

exports[`inlineChangesHighlighted commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                                                          
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Wed Apr 14 18:24:29 2021 -0700                                                                                  
                                                                                                                        
    test binary file addition                                                                                           
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                                                              
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`inlineChangesHighlighted commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`inlineChangesHighlighted commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                                                                     
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                                                             
    4  - このリポジトリは、MS-DOS ░░░░░░及び MS-DOS v2.0 のオリジナルのソースコード及    4  + このリポジトリは、MS-DOS 及び MS-DOS v2.0 のオリジナルのソースコード及びコンパイル
    4                                                           5                                                       
"
`;

exports[`inlineChangesHighlighted commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sat Apr 10 14:35:42 2021 -0700                                                                                  
                                                                                                                        
    wip                                                                                                                 
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                                                          
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                                                         
                                                                1  + node_modules/**                                    
                                                                2  + build/**                                           
                                                                3    No newline at end of file                          
"
`;

exports[`inlineChangesHighlighted commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 18 03:17:05 2021 -0700                                                                                  
                                                                                                                        
    Update main.yml                                                                                                     
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■                                                                                                                     
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                                                         
    1  - on run argv                                                                                                    
    2  -     with timeout of 5 seconds                                                                                  
    3  -         tell app "Terminal"                                                                                    
    4  -             open "screenshots.sh"                                                                              
    5  -         end tell                                                                                               
    6  -     end timeout                                                                                                
    7  - end run                                                                                                        
    1    No newline at end of file                                                                                      
"
`;

exports[`inlineChangesHighlighted commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sat Apr 10 22:26:15 2021 -0700                                                                                  
                                                                                                                        
    Move sample diff files                                                                                              
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                                                                
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`inlineChangesHighlighted commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 4 19:04:26 2021 -0700                                                                                   
                                                                                                                        
    update lockfile                                                                                                     
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                                                                  
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                                                             
    5  -         "revision": ░░░░                               5  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -8 +8 @@                                                                                                             
    8  -         "revision": ░░░░                               8  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -11 +11 @@                                                                                                           
   11  -         "revision": ░░░░                              11  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -16 +16 @@                                                                                                           
   16  -         "version": "1.░░.░░░",                        16  +         "version": "1.░░.░",                       
@@ -17,0 +18 @@                                                                                                         
                                                               18  +           "rebuild": 0,                            
@@ -19,0 +21 @@                                                                                                         
                                                               21  +           "root_url": "https://homebrew.bintray.com
@@ -20,0 +23,8 @@                                                                                                       
                                                               23  +             "arm64_big_sur": {                     
                                                               24  +               "url": "https://homebrew.bintray.com/
                                                               25  +               "sha256": "e7c1efdd09e951eb46d01a3200
                                                               26  +             },                                     
                                                               27  +             "big_sur": {                           
                                                               28  +               "url": "https://homebrew.bintray.com/
                                                               29  +               "sha256": "ea37f33fd27369612a3e4e6db6
                                                               30  +             },                                     
@@ -22,2 +32,2 @@                                                                                                       
   22  -               "url": "https://homebrew.bintray.com/   32  +               "url": "https://homebrew.bintray.com/
   23  -               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░   33  +               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -26,6 +36,2 @@                                                                                                       
   26  -               "url": "https://homebrew.bintray.com/   36  +               "url": "https://homebrew.bintray.com/
   27  -               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░   37  +               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░
   28  -             },                                                                                                 
   29  -             "high_sierra": {                                                                                   
   30  -               "url": "https://homebrew.bintray.com/                                                            
   31  -               "sha256": "0997f6f5cda0e3bdb7789a80b5                                                            
   26                                                          38                                                       
"
`;

exports[`inlineChangesHighlighted commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 15:25:34 2021 -0700                                                                                  
                                                                                                                        
    Add theme support                                                                                                   
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                                                         
    9    -        [x] Organize code                             9    -        [x] Organize code                         
                                                               10  + -        [x] Move visual config to theme           
   10    -        [ ] Handle empty diffs                       11    -        [ ] Handle empty diffs                    
   11                                                          12                                                       
"
`;

exports[`inlineChangesHighlighted commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                                                          
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 16:23:54 2021 -0700                                                                                  
                                                                                                                        
    Small refactor to allow testing end-to-end                                                                          
                                                                                                                        
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 11:53:02 2021 -0700                                                                                  
                                                                                                                        
    Organize code                                                                                                       
                                                                                                                        
commit f323143e03af95fee5d38c21238a92ffd4461847                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 10:39:17 2021 -0700                                                                                  
                                                                                                                        
    more todos                                                                                                          
                                                                                                                        
"
`;

exports[`inlineChangesHighlighted diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                                                               
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                                                           
    1  - This is file1                                                                                                  
    1    No newline at end of file                              1    No newline at end of file                          
                                                                2  + This is file1                                      
                                                                3  + Experimental change                                
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                                                               
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                                                           
                                                                1  + All good                                           
    1    This is file2                                          2    This is file2                                      
"
`;

exports[`inlineChangesHighlighted empty 1`] = `
"
"
`;

exports[`inlineChangesHighlighted merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                                                         
Merge: 2439767601 fbcdb8cf4f                                                                                            
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                                                                
Date:   Thu Dec 21 17:57:42 2023 -0800                                                                                  
                                                                                                                        
    Merge branch 'main' into gabritto/d2                                                                                
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                                                              
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                                                                    
  137        isBlock,                                                                                                   
  138        isBlockOrCatchScoped,                                                                                      
  139        IsBlockScopedContainer,                                                                                    
  140  +     isBooleanLiteral,                                                                                          
  141        isCallExpression,                                                                                          
  142        isClassStaticBlockDeclaration,                                                                             
  143  +     isConditionalExpression,                                                                                   
  144        isConditionalTypeNode,                                                                                     
  145        IsContainer,                                                                                               
  146        isDeclaration,                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                                                               
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                                                              
 6063        decoratorSignature?: Signature;     // Signature for decorator as if invoked by the runtime.               
 6064        spreadIndices?: { first: number | undefined, last: number | undefined }; // Indices of first and last sprea
 6065        parameterInitializerContainsUndefined?: boolean; // True if this is a parameter declaration whose type anno
 6066  -     fakeScopeForSignatureDeclaration?: boolean; // True if this is a fake scope injected into an enclosing decl
 6066  +     contextualReturnType?: Type;        // If the node is a return statement's expression, then this is the con
 6067  +     fakeScopeForSignatureDeclaration?: "params" | "typeParams"; // If present, this is a fake scope injected in
 6068        assertionExpressionType?: Type;     // Cached type of the expression of a type assertion                   
 6069    }                                                                                                              
"
`;

exports[`inlineChangesHighlighted merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                                                         
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                                                                 
Author: Andy Hanson <anhans@microsoft.com>                                                                              
Date:   Thu Sep 1 12:52:42 2016 -0700                                                                                   
                                                                                                                        
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into constructor_references                   
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                                                            
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                                                              
 2792            return node && node.parent && node.parent.kind === SyntaxKind.PropertyAccessExpression && (<PropertyAcc
 2793        }                                                                                                          
 2794                                                                                                                   
 2795  +     function climbPastPropertyAccess(node: Node) {                                                             
 2796  +         return isRightSideOfPropertyAccess(node) ? node.parent : node;                                         
 2797  +     }                                                                                                          
 2798  +                                                                                                                
 2799  -     function climbPastManyPropertyAccesses(node: Node): Node {                                                 
 2800  -         return isRightSideOfPropertyAccess(node) ? climbPastManyPropertyAccesses(node.parent) : node;          
 2799  +     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\` or \`class C extends foo.N\` where \`N\` is
 2800  +     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDeclaration | undefined {                    
 2801  +         return tryGetClassExtendingExpressionWithTypeArguments(climbPastPropertyAccess(node).parent);          
 2802  +     }                                                                                                          
 2803  +                                                                                                                
 2804        function isCallExpressionTarget(node: Node): boolean {                                                     
 2805  -         if (isRightSideOfPropertyAccess(node)) {                                                               
 2806  -             node = node.parent;                                                                                
 2807  -         }                                                                                                      
 2808  -         node = climbPastPropertyAccess(node);                                                                  
 2809  -         return node && node.parent && node.parent.kind === SyntaxKind.CallExpression && (<CallExpression>node.p
 2805  +         return isCallOrNewExpressionTarget(node, SyntaxKind.CallExpression);                                   
 2806        }                                                                                                          
 2807                                                                                                                   
 2808        function isNewExpressionTarget(node: Node): boolean {                                                      
 2809  -         if (isRightSideOfPropertyAccess(node)) {                                                               
 2810  -             node = node.parent;                                                                                
 2811  -         }                                                                                                      
 2812  -         node = climbPastPropertyAccess(node);                                                                  
 2813  -         return node && node.parent && node.parent.kind === SyntaxKind.NewExpression && (<CallExpression>node.pa
 2809  +         return isCallOrNewExpressionTarget(node, SyntaxKind.NewExpression);                                    
 2810  +     }                                                                                                          
 2811  +                                                                                                                
 2812  +     function isCallOrNewExpressionTarget(node: Node, kind: SyntaxKind) {                                       
 2813  +         const target = climbPastPropertyAccess(node);                                                          
 2814  +         return target && target.parent && target.parent.kind === kind && (<CallExpression>target.parent).expres
 2815  +     }                                                                                                          
 2816  +                                                                                                                
 2817  -     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\` or \`class C extends foo.N\` where \`N\` is
 2818  -     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDeclaration | undefined {                    
 2819  -         return tryGetClassExtendingExpressionWithTypeArguments(climbPastPropertyAccess(node).parent);          
 2817  +     function climbPastManyPropertyAccesses(node: Node): Node {                                                 
 2818  +         return isRightSideOfPropertyAccess(node) ? climbPastManyPropertyAccesses(node.parent) : node;          
 2819  +     }                                                                                                          
 2820  +                                                                                                                
 2821  +     /** Returns a CallLikeExpression where \`node\` is the target being invoked. */                              
 2822  +     function getAncestorCallLikeExpression(node: Node): CallLikeExpression | undefined {                       
 2823  +         const target = climbPastManyPropertyAccesses(node);                                                    
 2824  +         const callLike = target.parent;                                                                        
 2825  +         return callLike && isCallLikeExpression(callLike) && getInvokedExpression(callLike) === target && callL
 2826  +     }                                                                                                          
 2827  +                                                                                                                
 2828  +     function tryGetSignatureDeclaration(typeChecker: TypeChecker, node: Node): SignatureDeclaration | undefined
 2829  +         const callLike = getAncestorCallLikeExpression(node);                                                  
 2830  +         return callLike && typeChecker.getResolvedSignature(callLike).declaration;                             
 2831        }                                                                                                          
 2832                                                                                                                   
 2833        function isNameOfModuleDeclaration(node: Node) {                                                           
 2834                                                                                                                   
"
`;

exports[`inlineChangesHighlighted multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 16:23:54 2021 -0700                                                                                  
                                                                                                                        
    Small refactor to allow testing end-to-end                                                                          
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                                                         
    1    import chalk from 'chalk';                             1    import chalk from 'chalk';                         
    2    import * as process from 'process';                    2    import * as process from 'process';                
                                                                3  + import stream from 'stream';                       
    3    import terminalSize from 'terminal-size';              4    import terminalSize from 'terminal-size';          
    4    import { iterlinesFromReadableAsync } from './iterL    5    import { iterlinesFromReadableAsync } from './iterL
    5    import { iterLinesWithoutAnsiColors } from './iterL    6    import { iterLinesWithoutAnsiColors } from './iterL
@@ -12,15 +13,16 @@ function main() {                                                                                   
   12        const screenWidth = terminalSize().columns;       13        const screenWidth = terminalSize().columns;    
   13        const theme = defaultTheme(chalk, screenWidth);   14        const theme = defaultTheme(chalk, screenWidth);
   14                                                          15                                                       
   15  -     transformStreamWithIterables(                     16  +     stream.pipeline(                               
   16  -         process.stdin,                                17  +         transformStreamWithIterables(              
   17  -         [                                             18  +             process.stdin,                         
   15                iterlinesFromReadableAsync,               19                iterlinesFromReadableAsync,            
   16                iterLinesWithoutAnsiColors,               20                iterLinesWithoutAnsiColors,            
   17                iterSideBySideDiff(theme),                21                iterSideBySideDiff(theme),             
   18  -             iterWithNewlines░                         22  +             iterWithNewlines                       
   19  -         ░,                                            23  +         ░,                                         
   20  -         process.stdout                                24  +         process.stdout░                            
                                                               25  +         console.error                              
   18        );                                                26        );                                             
   19    }                                                     27    }                                                  
   20                                                          28                                                       
"
`;

exports[`inlineChangesHighlighted with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                                                         
Author: Shrey Banga <banga.shrey@gmail.com>                                                                             
Date:   Sun Apr 11 15:25:34 2021 -0700                                                                                  
                                                                                                                        
    Add theme support                                                                                                   
                                                                                                                        
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                                                             
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                                                         
    7    -   [x] Handle file addition/deletion properly         7    -   [x] Handle file addition/deletion properly     
    8    -   [x] Fix incorrect line positions when a hunk ha    8    -   [x] Fix incorrect line positions when a hunk ha
    9    -   [x] Organize code                                  9    -   [x] Organize code                              
                                                               10  + -   [x] Move visual config to theme                
   10    -   [ ] Handle empty diffs                            11    -   [ ] Handle empty diffs                         
   11    -   [ ] Handle moves and renames without diffs        12    -   [ ] Handle moves and renames without diffs     
   12    -   [ ] Highlight changes in lines                    13    -   [ ] Highlight changes in lines                 
   13                                                          14                                                       
   14                                                          15                                                       
"
`;

exports[`splitWithWrapping commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`splitWithWrapping commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`splitWithWrapping commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -   [x] Organize code              9    -   [x] Organize code          
                                           10  + -   [x] Move visual config to  
                                                 theme                          
   10    -   [ ] Handle empty diffs        11    -   [ ] Handle empty diffs     
   11                                      12                                   
"
`;

exports[`splitWithWrapping commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Wed Apr 14 18:24:29 2021 -0700                                          
                                                                                
    test binary file addition                                                   
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                     
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                      
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`splitWithWrapping commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`splitWithWrapping commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                             
────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                     
    4  - このリポジトリは、MS-DOS v1.25     4  + このリポジトリは、MS-DOS 及び  
         及び MS-DOS v2.0 のオリジナルの         MS-DOS v2.0 のオリジナルのソー 
         ソースコード及びコンパイルされ          スコード及びコンパイルされたバ 
         たバイナリを含んでいます。              イナリを含んでいます。         
                                                                                
    4                                       5                                   
"
`;

exports[`splitWithWrapping commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 14:35:42 2021 -0700                                          
                                                                                
    wip                                                                         
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                  
────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                 
                                            1  + node_modules/**                
                                            2  + build/**                       
                                            3    No newline at end of file      
"
`;

exports[`splitWithWrapping commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 18 03:17:05 2021 -0700                                          
                                                                                
    Update main.yml                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■                                                                             
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                 
    1  - on run argv                                                            
    2  -     with timeout of 5 seconds                                          
    3  -         tell app "Terminal"                                            
    4  -             open                                                       
         "screenshots.sh"                                                       
    5  -         end tell                                                       
    6  -     end timeout                                                        
    7  - end run                                                                
    1    No newline at end of file                                              
"
`;

exports[`splitWithWrapping commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 22:26:15 2021 -0700                                          
                                                                                
    Move sample diff files                                                      
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                        
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`splitWithWrapping commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 4 19:04:26 2021 -0700                                           
                                                                                
    update lockfile                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                          
────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                     
    5  -         "revision": null           5  +         "revision": "ee2f8d3ba2
                                                 976e50ef577d517bf175c94fbbb0dd"
@@ -8 +8 @@                                                                     
    8  -         "revision": null           8  +         "revision": "c4cf96857c
                                                 050dfa4f65f52109862dc68e55f60a"
@@ -11 +11 @@                                                                   
   11  -         "revision": null          11  +         "revision": "504d4b93aa
                                                 6eaf4fce1bf17c19f55828ad7229a4"
@@ -16 +16 @@                                                                   
   16  -         "version": "1.14.2_1",    16  +         "version": "1.16.3",   
@@ -17,0 +18 @@                                                                 
                                           18  +           "rebuild": 0,        
@@ -19,0 +21 @@                                                                 
                                           21  +           "root_url": "https://
                                                 homebrew.bintray.com/bottles", 
@@ -20,0 +23,8 @@                                                               
                                           23  +             "arm64_big_sur": { 
                                           24  +               "url": "https://h
                                                 omebrew.bintray.com/bottles/go-
                                                 1.16.3.arm64_big_sur.bottle.tar
                                                 .gz",                          
                                           25  +               "sha256": "e7c1ef
                                                 dd09e951eb46d01a3200b01e7fa55ce
                                                 285b75470051be7fef34f4233ce"   
                                           26  +             },                 
                                           27  +             "big_sur": {       
                                           28  +               "url": "https://h
                                                 omebrew.bintray.com/bottles/go-
                                                 1.16.3.big_sur.bottle.tar.gz", 
                                           29  +               "sha256": "ea37f3
                                                 3fd27369612a3e4e6db6adc46db0e8b
                                                 df6fac1332bf51bafaa66d43969"   
                                           30  +             },                 
@@ -22,2 +32,2 @@                                                               
   22  -               "url": "https://h   32  +               "url": "https://h
         omebrew.bintray.com/bottles/go-         omebrew.bintray.com/bottles/go-
         1.14.2_1.catalina.bottle.tar.gz         1.16.3.catalina.bottle.tar.gz",
         ",                                                                     
   23  -               "sha256": "15b562   33  +               "sha256": "69c28f
         3471330edcc681d7f9d57b449660e6d         5e60612801c66e51e93d32068f822b2
         4b98c7f67af67f4991fc75d61fc"            45ab83246cb6cb374572eb59e15"   
@@ -26,6 +36,2 @@                                                               
   26  -               "url": "https://h   36  +               "url": "https://h
         omebrew.bintray.com/bottles/go-         omebrew.bintray.com/bottles/go-
         1.14.2_1.mojave.bottle.tar.gz",         1.16.3.mojave.bottle.tar.gz",  
   27  -               "sha256": "fa65e7   37  +               "sha256": "bf1e90
         dabe514e65ae625ed3c84a6bf58df01         ed1680b8ee1acb49f2f99426c8a8ac3
         aceffc6e9aa99752ca8c320ce69"            e49efd63c7f3b41e57e7214dd19"   
   28  -             },                                                         
   29  -             "high_sierra": {                                           
   30  -               "url": "https://h                                        
         omebrew.bintray.com/bottles/go-                                        
         1.14.2_1.high_sierra.bottle.tar                                        
         .gz",                                                                  
   31  -               "sha256": "0997f6                                        
         f5cda0e3bdb7789a80b53621cb58820                                        
         2ab37fd89bcd269f8dfafd23351"                                           
   26                                      38                                   
"
`;

exports[`splitWithWrapping commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -        [x] Organize code         9    -        [x] Organize code     
                                           10  + -        [x] Move visual config
                                                  to theme                      
   10    -        [ ] Handle empty diffs   11    -        [ ] Handle empty diffs
   11                                      12                                   
"
`;

exports[`splitWithWrapping commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 11:53:02 2021 -0700                                          
                                                                                
    Organize code                                                               
                                                                                
commit f323143e03af95fee5d38c21238a92ffd4461847                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 10:39:17 2021 -0700                                          
                                                                                
    more todos                                                                  
                                                                                
"
`;

exports[`splitWithWrapping diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  - This is file1                                                          
    1    No newline at end of file          1    No newline at end of file      
                                            2  + This is file1                  
                                            3  + Experimental change            
────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
                                            1  + All good                       
    1    This is file2                      2    This is file2                  
"
`;

exports[`splitWithWrapping empty 1`] = `
"
"
`;

exports[`splitWithWrapping merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                 
Merge: 2439767601 fbcdb8cf4f                                                    
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                        
Date:   Thu Dec 21 17:57:42 2023 -0800                                          
                                                                                
    Merge branch 'main' into gabritto/d2                                        
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                      
────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                            
  137        isBlock,                                                           
  138        isBlockOrCatchScoped,                                              
  139        IsBlockScopedContainer,                                            
  140  +     isBooleanLiteral,                                                  
  141        isCallExpression,                                                  
  142        isClassStaticBlockDeclaration,                                     
  143  +     isConditionalExpression,                                           
  144        isConditionalTypeNode,                                             
  145        IsContainer,                                                       
  146        isDeclaration,                                                     
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                       
────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                      
 6063        decoratorSignature?: Signature;     // Signature for decorator as  
         if invoked by the runtime.                                             
 6064        spreadIndices?: { first: number | undefined, last: number |        
         undefined }; // Indices of first and last spread elements in array     
         literal                                                                
 6065        parameterInitializerContainsUndefined?: boolean; // True if this is
          a parameter declaration whose type annotation contains "undefined".   
 6066  -     fakeScopeForSignatureDeclaration?: boolean; // True if this is a   
         fake scope injected into an enclosing declaration chain.               
 6066  +     contextualReturnType?: Type;        // If the node is a return     
         statement's expression, then this is the contextual return type.       
 6067  +     fakeScopeForSignatureDeclaration?: "params" | "typeParams"; // If  
         present, this is a fake scope injected into an enclosing declaration   
         chain.                                                                 
 6068        assertionExpressionType?: Type;     // Cached type of the          
         expression of a type assertion                                         
 6069    }                                                                      
"
`;

exports[`splitWithWrapping merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                 
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                         
Author: Andy Hanson <anhans@microsoft.com>                                      
Date:   Thu Sep 1 12:52:42 2016 -0700                                           
                                                                                
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into  
constructor_references                                                          
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                    
────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                      
 2792            return node && node.parent && node.parent.kind ===             
         SyntaxKind.PropertyAccessExpression &&                                 
         (<PropertyAccessExpression>node.parent).name === node;                 
 2793        }                                                                  
 2794                                                                           
 2795  +     function climbPastPropertyAccess(node: Node) {                     
 2796  +         return isRightSideOfPropertyAccess(node) ? node.parent : node; 
 2797  +     }                                                                  
 2798  +                                                                        
 2799  -     function climbPastManyPropertyAccesses(node: Node): Node {         
 2800  -         return isRightSideOfPropertyAccess(node) ?                     
         climbPastManyPropertyAccesses(node.parent) : node;                     
 2799  +     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
          or \`class C extends foo.N\` where \`N\` is an identifier. */             
 2800  +     function tryGetClassExtendingIdentifier(node: Node):               
         ClassLikeDeclaration | undefined {                                     
 2801  +         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
         tPropertyAccess(node).parent);                                         
 2802  +     }                                                                  
 2803  +                                                                        
 2804        function isCallExpressionTarget(node: Node): boolean {             
 2805  -         if (isRightSideOfPropertyAccess(node)) {                       
 2806  -             node = node.parent;                                        
 2807  -         }                                                              
 2808  -         node = climbPastPropertyAccess(node);                          
 2809  -         return node && node.parent && node.parent.kind ===             
         SyntaxKind.CallExpression && (<CallExpression>node.parent).expression  
         === node;                                                              
 2805  +         return isCallOrNewExpressionTarget(node,                       
         SyntaxKind.CallExpression);                                            
 2806        }                                                                  
 2807                                                                           
 2808        function isNewExpressionTarget(node: Node): boolean {              
 2809  -         if (isRightSideOfPropertyAccess(node)) {                       
 2810  -             node = node.parent;                                        
 2811  -         }                                                              
 2812  -         node = climbPastPropertyAccess(node);                          
 2813  -         return node && node.parent && node.parent.kind ===             
         SyntaxKind.NewExpression && (<CallExpression>node.parent).expression   
         === node;                                                              
 2809  +         return isCallOrNewExpressionTarget(node,                       
         SyntaxKind.NewExpression);                                             
 2810  +     }                                                                  
 2811  +                                                                        
 2812  +     function isCallOrNewExpressionTarget(node: Node, kind: SyntaxKind) 
         {                                                                      
 2813  +         const target = climbPastPropertyAccess(node);                  
 2814  +         return target && target.parent && target.parent.kind === kind  
         && (<CallExpression>target.parent).expression === target;              
 2815  +     }                                                                  
 2816  +                                                                        
 2817  -     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
          or \`class C extends foo.N\` where \`N\` is an identifier. */             
 2818  -     function tryGetClassExtendingIdentifier(node: Node):               
         ClassLikeDeclaration | undefined {                                     
 2819  -         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
         tPropertyAccess(node).parent);                                         
 2817  +     function climbPastManyPropertyAccesses(node: Node): Node {         
 2818  +         return isRightSideOfPropertyAccess(node) ?                     
         climbPastManyPropertyAccesses(node.parent) : node;                     
 2819  +     }                                                                  
 2820  +                                                                        
 2821  +     /** Returns a CallLikeExpression where \`node\` is the target being  
         invoked. */                                                            
 2822  +     function getAncestorCallLikeExpression(node: Node):                
         CallLikeExpression | undefined {                                       
 2823  +         const target = climbPastManyPropertyAccesses(node);            
 2824  +         const callLike = target.parent;                                
 2825  +         return callLike && isCallLikeExpression(callLike) &&           
         getInvokedExpression(callLike) === target && callLike;                 
 2826  +     }                                                                  
 2827  +                                                                        
 2828  +     function tryGetSignatureDeclaration(typeChecker: TypeChecker, node:
          Node): SignatureDeclaration | undefined {                             
 2829  +         const callLike = getAncestorCallLikeExpression(node);          
 2830  +         return callLike &&                                             
         typeChecker.getResolvedSignature(callLike).declaration;                
 2831        }                                                                  
 2832                                                                           
 2833        function isNameOfModuleDeclaration(node: Node) {                   
 2834                                                                           
"
`;

exports[`splitWithWrapping multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                
────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                 
    1    import chalk from 'chalk';         1    import chalk from 'chalk';     
    2    import * as process from           2    import * as process from       
         'process';                              'process';                     
                                            3  + import stream from 'stream';   
    3    import terminalSize from           4    import terminalSize from       
         'terminal-size';                        'terminal-size';               
    4    import {                           5    import {                       
         iterlinesFromReadableAsync }            iterlinesFromReadableAsync }   
         from './iterLinesFromReadable';         from './iterLinesFromReadable';
    5    import {                           6    import {                       
         iterLinesWithoutAnsiColors }            iterLinesWithoutAnsiColors }   
         from                                    from                           
         './iterLinesWithoutAnsiColors';         './iterLinesWithoutAnsiColors';
@@ -12,15 +13,16 @@ function main() {                                           
   12        const screenWidth =           13        const screenWidth =        
         terminalSize().columns;                 terminalSize().columns;        
   13        const theme =                 14        const theme =              
         defaultTheme(chalk,                     defaultTheme(chalk,            
         screenWidth);                           screenWidth);                  
   14                                      15                                   
   15  -                                   16  +     stream.pipeline(           
         transformStreamWithIterables(                                          
   16  -         process.stdin,            17  +                                
                                                 transformStreamWithIterables(  
   17  -         [                         18  +             process.stdin,     
   15                                      19                                   
         iterlinesFromReadableAsync,             iterlinesFromReadableAsync,    
   16                                      20                                   
         iterLinesWithoutAnsiColors,             iterLinesWithoutAnsiColors,    
   17                                      21                                   
         iterSideBySideDiff(theme),              iterSideBySideDiff(theme),     
   18  -             iterWithNewlines,     22  +             iterWithNewlines   
   19  -         ],                        23  +         ),                     
   20  -         process.stdout            24  +         process.stdout,        
                                           25  +         console.error          
   18        );                            26        );                         
   19    }                                 27    }                              
   20                                      28                                   
"
`;

exports[`splitWithWrapping with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                 
    7    -   [x] Handle file                7    -   [x] Handle file            
         addition/deletion properly              addition/deletion properly     
    8    -   [x] Fix incorrect line         8    -   [x] Fix incorrect line     
         positions when a hunk has               positions when a hunk has      
         discontinuous inserts and/or            discontinuous inserts and/or   
         deletes                                 deletes                        
    9    -   [x] Organize code              9    -   [x] Organize code          
                                           10  + -   [x] Move visual config to  
                                                 theme                          
   10    -   [ ] Handle empty diffs        11    -   [ ] Handle empty diffs     
   11    -   [ ] Handle moves and          12    -   [ ] Handle moves and       
         renames without diffs                   renames without diffs          
   12    -   [ ] Highlight changes in      13    -   [ ] Highlight changes in   
         lines                                   lines                          
   13                                      14                                   
   14                                      15                                   
"
`;

exports[`splitWithoutWrapping commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`splitWithoutWrapping commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`splitWithoutWrapping commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -   [x] Organize code              9    -   [x] Organize code          
                                           10  + -   [x] Move visual config to t
   10    -   [ ] Handle empty diffs        11    -   [ ] Handle empty diffs     
   11                                      12                                   
"
`;

exports[`splitWithoutWrapping commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Wed Apr 14 18:24:29 2021 -0700                                          
                                                                                
    test binary file addition                                                   
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                     
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                      
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`splitWithoutWrapping commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`splitWithoutWrapping commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                             
────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                     
    4  - このリポジトリは、MS-DOS v1.25 及び MS-DOS    4  + このリポジトリは、MS-DOS 及び MS-DOS v2.0 
    4                                       5                                   
"
`;

exports[`splitWithoutWrapping commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 14:35:42 2021 -0700                                          
                                                                                
    wip                                                                         
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                  
────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                 
                                            1  + node_modules/**                
                                            2  + build/**                       
                                            3    No newline at end of file      
"
`;

exports[`splitWithoutWrapping commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 18 03:17:05 2021 -0700                                          
                                                                                
    Update main.yml                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■                                                                             
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                 
    1  - on run argv                                                            
    2  -     with timeout of 5 seconds                                          
    3  -         tell app "Terminal"                                            
    4  -             open "screenshots.s                                        
    5  -         end tell                                                       
    6  -     end timeout                                                        
    7  - end run                                                                
    1    No newline at end of file                                              
"
`;

exports[`splitWithoutWrapping commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 22:26:15 2021 -0700                                          
                                                                                
    Move sample diff files                                                      
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                        
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`splitWithoutWrapping commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 4 19:04:26 2021 -0700                                           
                                                                                
    update lockfile                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                          
────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                     
    5  -         "revision": null           5  +         "revision": "ee2f8d3ba2
@@ -8 +8 @@                                                                     
    8  -         "revision": null           8  +         "revision": "c4cf96857c
@@ -11 +11 @@                                                                   
   11  -         "revision": null          11  +         "revision": "504d4b93aa
@@ -16 +16 @@                                                                   
   16  -         "version": "1.14.2_1",    16  +         "version": "1.16.3",   
@@ -17,0 +18 @@                                                                 
                                           18  +           "rebuild": 0,        
@@ -19,0 +21 @@                                                                 
                                           21  +           "root_url": "https://
@@ -20,0 +23,8 @@                                                               
                                           23  +             "arm64_big_sur": { 
                                           24  +               "url": "https://h
                                           25  +               "sha256": "e7c1ef
                                           26  +             },                 
                                           27  +             "big_sur": {       
                                           28  +               "url": "https://h
                                           29  +               "sha256": "ea37f3
                                           30  +             },                 
@@ -22,2 +32,2 @@                                                               
   22  -               "url": "https://h   32  +               "url": "https://h
   23  -               "sha256": "15b562   33  +               "sha256": "69c28f
@@ -26,6 +36,2 @@                                                               
   26  -               "url": "https://h   36  +               "url": "https://h
   27  -               "sha256": "fa65e7   37  +               "sha256": "bf1e90
   28  -             },                                                         
   29  -             "high_sierra": {                                           
   30  -               "url": "https://h                                        
   31  -               "sha256": "0997f6                                        
   26                                      38                                   
"
`;

exports[`splitWithoutWrapping commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -        [x] Organize code         9    -        [x] Organize code     
                                           10  + -        [x] Move visual config
   10    -        [ ] Handle empty diffs   11    -        [ ] Handle empty diffs
   11                                      12                                   
"
`;

exports[`splitWithoutWrapping commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 11:53:02 2021 -0700                                          
                                                                                
    Organize code                                                               
                                                                                
commit f323143e03af95fee5d38c21238a92ffd4461847                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 10:39:17 2021 -0700                                          
                                                                                
    more todos                                                                  
                                                                                
"
`;

exports[`splitWithoutWrapping diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  - This is file1                                                          
    1    No newline at end of file          1    No newline at end of file      
                                            2  + This is file1                  
                                            3  + Experimental change            
────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
                                            1  + All good                       
    1    This is file2                      2    This is file2                  
"
`;

exports[`splitWithoutWrapping empty 1`] = `
"
"
`;

exports[`splitWithoutWrapping merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                 
Merge: 2439767601 fbcdb8cf4f                                                    
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                        
Date:   Thu Dec 21 17:57:42 2023 -0800                                          
                                                                                
    Merge branch 'main' into gabritto/d2                                        
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                      
────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                            
  137        isBlock,                                                           
  138        isBlockOrCatchScoped,                                              
  139        IsBlockScopedContainer,                                            
  140  +     isBooleanLiteral,                                                  
  141        isCallExpression,                                                  
  142        isClassStaticBlockDeclaration,                                     
  143  +     isConditionalExpression,                                           
  144        isConditionalTypeNode,                                             
  145        IsContainer,                                                       
  146        isDeclaration,                                                     
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                       
────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                      
 6063        decoratorSignature?: Signature;     // Signature for decorator as i
 6064        spreadIndices?: { first: number | undefined, last: number | undefin
 6065        parameterInitializerContainsUndefined?: boolean; // True if this is
 6066  -     fakeScopeForSignatureDeclaration?: boolean; // True if this is a fa
 6066  +     contextualReturnType?: Type;        // If the node is a return stat
 6067  +     fakeScopeForSignatureDeclaration?: "params" | "typeParams"; // If p
 6068        assertionExpressionType?: Type;     // Cached type of the expressio
 6069    }                                                                      
"
`;

exports[`splitWithoutWrapping merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                 
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                         
Author: Andy Hanson <anhans@microsoft.com>                                      
Date:   Thu Sep 1 12:52:42 2016 -0700                                           
                                                                                
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into c
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                    
────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                      
 2792            return node && node.parent && node.parent.kind === SyntaxKind.P
 2793        }                                                                  
 2794                                                                           
 2795  +     function climbPastPropertyAccess(node: Node) {                     
 2796  +         return isRightSideOfPropertyAccess(node) ? node.parent : node; 
 2797  +     }                                                                  
 2798  +                                                                        
 2799  -     function climbPastManyPropertyAccesses(node: Node): Node {         
 2800  -         return isRightSideOfPropertyAccess(node) ? climbPastManyPropert
 2799  +     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
 2800  +     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDecla
 2801  +         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
 2802  +     }                                                                  
 2803  +                                                                        
 2804        function isCallExpressionTarget(node: Node): boolean {             
 2805  -         if (isRightSideOfPropertyAccess(node)) {                       
 2806  -             node = node.parent;                                        
 2807  -         }                                                              
 2808  -         node = climbPastPropertyAccess(node);                          
 2809  -         return node && node.parent && node.parent.kind === SyntaxKind.C
 2805  +         return isCallOrNewExpressionTarget(node, SyntaxKind.CallExpress
 2806        }                                                                  
 2807                                                                           
 2808        function isNewExpressionTarget(node: Node): boolean {              
 2809  -         if (isRightSideOfPropertyAccess(node)) {                       
 2810  -             node = node.parent;                                        
 2811  -         }                                                              
 2812  -         node = climbPastPropertyAccess(node);                          
 2813  -         return node && node.parent && node.parent.kind === SyntaxKind.N
 2809  +         return isCallOrNewExpressionTarget(node, SyntaxKind.NewExpressi
 2810  +     }                                                                  
 2811  +                                                                        
 2812  +     function isCallOrNewExpressionTarget(node: Node, kind: SyntaxKind) 
 2813  +         const target = climbPastPropertyAccess(node);                  
 2814  +         return target && target.parent && target.parent.kind === kind &
 2815  +     }                                                                  
 2816  +                                                                        
 2817  -     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
 2818  -     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDecla
 2819  -         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
 2817  +     function climbPastManyPropertyAccesses(node: Node): Node {         
 2818  +         return isRightSideOfPropertyAccess(node) ? climbPastManyPropert
 2819  +     }                                                                  
 2820  +                                                                        
 2821  +     /** Returns a CallLikeExpression where \`node\` is the target being i
 2822  +     function getAncestorCallLikeExpression(node: Node): CallLikeExpress
 2823  +         const target = climbPastManyPropertyAccesses(node);            
 2824  +         const callLike = target.parent;                                
 2825  +         return callLike && isCallLikeExpression(callLike) && getInvoked
 2826  +     }                                                                  
 2827  +                                                                        
 2828  +     function tryGetSignatureDeclaration(typeChecker: TypeChecker, node:
 2829  +         const callLike = getAncestorCallLikeExpression(node);          
 2830  +         return callLike && typeChecker.getResolvedSignature(callLike).d
 2831        }                                                                  
 2832                                                                           
 2833        function isNameOfModuleDeclaration(node: Node) {                   
 2834                                                                           
"
`;

exports[`splitWithoutWrapping multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                
────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                 
    1    import chalk from 'chalk';         1    import chalk from 'chalk';     
    2    import * as process from 'proce    2    import * as process from 'proce
                                            3  + import stream from 'stream';   
    3    import terminalSize from 'termi    4    import terminalSize from 'termi
    4    import { iterlinesFromReadableA    5    import { iterlinesFromReadableA
    5    import { iterLinesWithoutAnsiCo    6    import { iterLinesWithoutAnsiCo
@@ -12,15 +13,16 @@ function main() {                                           
   12        const screenWidth = termina   13        const screenWidth = termina
   13        const theme = defaultTheme(   14        const theme = defaultTheme(
   14                                      15                                   
   15  -     transformStreamWithIterable   16  +     stream.pipeline(           
   16  -         process.stdin,            17  +         transformStreamWithIter
   17  -         [                         18  +             process.stdin,     
   15                iterlinesFromReadab   19                iterlinesFromReadab
   16                iterLinesWithoutAns   20                iterLinesWithoutAns
   17                iterSideBySideDiff(   21                iterSideBySideDiff(
   18  -             iterWithNewlines,     22  +             iterWithNewlines   
   19  -         ],                        23  +         ),                     
   20  -         process.stdout            24  +         process.stdout,        
                                           25  +         console.error          
   18        );                            26        );                         
   19    }                                 27    }                              
   20                                      28                                   
"
`;

exports[`splitWithoutWrapping with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                 
    7    -   [x] Handle file addition/de    7    -   [x] Handle file addition/de
    8    -   [x] Fix incorrect line posi    8    -   [x] Fix incorrect line posi
    9    -   [x] Organize code              9    -   [x] Organize code          
                                           10  + -   [x] Move visual config to t
   10    -   [ ] Handle empty diffs        11    -   [ ] Handle empty diffs     
   11    -   [ ] Handle moves and rename   12    -   [ ] Handle moves and rename
   12    -   [ ] Highlight changes in li   13    -   [ ] Highlight changes in li
   13                                      14                                   
   14                                      15                                   
"
`;

exports[`syntaxHighlighted commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`syntaxHighlighted commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                      19    brew 'socat'                   
                                           20  + brew 'sonos'                   
   20    brew 'terminal-notifier'          21    brew 'terminal-notifier'       
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                      43    cask 'slate'                   
   43  - cask 'sonos'                                                           
   43    cask 'spotify'                    44    cask 'spotify'                 
"
`;

exports[`syntaxHighlighted commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    ░░░░░░░░░░░░░░░░░░░░░              9    ░░░░░░░░░░░░░░░░░░░░░          
                                           10  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   10    ░░░░░░░░░░░░░░░░░░░░░░░░░░        11    ░░░░░░░░░░░░░░░░░░░░░░░░░░     
   11                                      12                                   
"
`;

exports[`syntaxHighlighted commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Wed Apr 14 18:24:29 2021 -0700                                          
                                                                                
    test binary file addition                                                   
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                     
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                      
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`syntaxHighlighted commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`syntaxHighlighted commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                             
────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                     
    4  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    4  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
    4                                       5                                   
"
`;

exports[`syntaxHighlighted commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 14:35:42 2021 -0700                                          
                                                                                
    wip                                                                         
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                  
────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                 
                                            1  + node_modules/**                
                                            2  + build/**                       
                                            3    No newline at end of file      
"
`;

exports[`syntaxHighlighted commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 18 03:17:05 2021 -0700                                          
                                                                                
    Update main.yml                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■                                                                             
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                 
    1  - on run argv                                                            
    2  -     with timeout of 5 seconds                                          
    3  -         tell app "Terminal"                                            
    4  -             open "screenshots.s                                        
    5  -         end tell                                                       
    6  -     end timeout                                                        
    7  - end run                                                                
    1    No newline at end of file                                              
"
`;

exports[`syntaxHighlighted commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 22:26:15 2021 -0700                                          
                                                                                
    Move sample diff files                                                      
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                        
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`syntaxHighlighted commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 4 19:04:26 2021 -0700                                           
                                                                                
    update lockfile                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                          
────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                     
    5  - ░░░░░░░░░░░░░░░░░░░░░░░░           5  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -8 +8 @@                                                                     
    8  - ░░░░░░░░░░░░░░░░░░░░░░░░           8  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -11 +11 @@                                                                   
   11  - ░░░░░░░░░░░░░░░░░░░░░░░░          11  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -16 +16 @@                                                                   
   16  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    16  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   
@@ -17,0 +18 @@                                                                 
                                           18  + ░░░░░░░░░░░░░░░░░░░░░░░        
@@ -19,0 +21 @@                                                                 
                                           21  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -20,0 +23,8 @@                                                               
                                           23  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
                                           24  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
                                           25  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
                                           26  + ░░░░░░░░░░░░░░                 
                                           27  + ░░░░░░░░░░░░░░░░░░░░░░░░       
                                           28  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
                                           29  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
                                           30  + ░░░░░░░░░░░░░░                 
@@ -22,2 +32,2 @@                                                               
   22  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   32  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   23  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   33  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -26,6 +36,2 @@                                                               
   26  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   36  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   27  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   37  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   28  - ░░░░░░░░░░░░░░                                                         
   29  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                           
   30  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                        
   31  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                        
   26                                      38                                   
"
`;

exports[`syntaxHighlighted commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    ░░░░░░░░░░░░░░░░░░░░░░░░░░         9    ░░░░░░░░░░░░░░░░░░░░░░░░░░     
                                           10  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   10    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   11    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   11                                      12                                   
"
`;

exports[`syntaxHighlighted commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 11:53:02 2021 -0700                                          
                                                                                
    Organize code                                                               
                                                                                
commit f323143e03af95fee5d38c21238a92ffd4461847                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 10:39:17 2021 -0700                                          
                                                                                
    more todos                                                                  
                                                                                
"
`;

exports[`syntaxHighlighted diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  - This is file1                                                          
    1    No newline at end of file          1    No newline at end of file      
                                            2  + This is file1                  
                                            3  + Experimental change            
────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
                                            1  + All good                       
    1    This is file2                      2    This is file2                  
"
`;

exports[`syntaxHighlighted empty 1`] = `
"
"
`;

exports[`syntaxHighlighted merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                 
Merge: 2439767601 fbcdb8cf4f                                                    
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                        
Date:   Thu Dec 21 17:57:42 2023 -0800                                          
                                                                                
    Merge branch 'main' into gabritto/d2                                        
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                      
────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                            
  137    ░░░░░░░░░░░░                                                           
  138    ░░░░░░░░░░░░░░░░░░░░░░░░░                                              
  139    ░░░░░░░░░░░░░░░░░░░░░░░░░░░                                            
  140  + ░░░░░░░░░░░░░░░░░░░░░                                                  
  141    ░░░░░░░░░░░░░░░░░░░░░                                                  
  142    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                     
  143  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                           
  144    ░░░░░░░░░░░░░░░░░░░░░░░░░░                                             
  145    ░░░░░░░░░░░░░░░░                                                       
  146    ░░░░░░░░░░░░░░░░░░                                                     
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                       
────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                      
 6063    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6064    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6065    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6066  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6066  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6067  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6068    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 6069    ░                                                                      
"
`;

exports[`syntaxHighlighted merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                 
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                         
Author: Andy Hanson <anhans@microsoft.com>                                      
Date:   Thu Sep 1 12:52:42 2016 -0700                                           
                                                                                
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into c
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                    
────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                      
 2792    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2793    ░░░░░                                                                  
 2794                                                                           
 2795  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                     
 2796  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
 2797  + ░░░░░                                                                  
 2798  +                                                                        
 2799  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░         
 2800  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2799  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2800  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2801  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2802  + ░░░░░                                                                  
 2803  +                                                                        
 2804    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░             
 2805  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                       
 2806  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                        
 2807  - ░░░░░░░░░                                                              
 2808  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                          
 2809  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2805  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2806    ░░░░░                                                                  
 2807                                                                           
 2808    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░              
 2809  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                       
 2810  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                        
 2811  - ░░░░░░░░░                                                              
 2812  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                          
 2813  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2809  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2810  + ░░░░░                                                                  
 2811  +                                                                        
 2812  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2813  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                  
 2814  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2815  + ░░░░░                                                                  
 2816  +                                                                        
 2817  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2818  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2819  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2817  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░         
 2818  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2819  + ░░░░░                                                                  
 2820  +                                                                        
 2821  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2822  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2823  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░            
 2824  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                                
 2825  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2826  + ░░░░░                                                                  
 2827  +                                                                        
 2828  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2829  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░          
 2830  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 2831    ░░░░░                                                                  
 2832                                                                           
 2833    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░                   
 2834                                                                           
"
`;

exports[`syntaxHighlighted multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                
────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                 
    1    ░░░░░░░░░░░░░░░░░░░░░░░░░░         1    ░░░░░░░░░░░░░░░░░░░░░░░░░░     
    2    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    2    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
                                            3  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   
    3    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    4    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
    4    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    5    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
    5    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    6    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -12,15 +13,16 @@ function main() {                                           
   12    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   13    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   13    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   14                                      15                                   
   15  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   16  + ░░░░░░░░░░░░░░░░░░░░           
   16  - ░░░░░░░░░░░░░░░░░░░░░░            17  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   17  - ░░░░░░░░░                         18  + ░░░░░░░░░░░░░░░░░░░░░░░░░░     
   15    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   19    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   16    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   20    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   17    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   18  - ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     22  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   
   19  - ░░░░░░░░░░                        23  + ░░░░░░░░░░                     
   20  - ░░░░░░░░░░░░░░░░░░░░░░            24  + ░░░░░░░░░░░░░░░░░░░░░░░        
                                           25  + ░░░░░░░░░░░░░░░░░░░░░          
   18    ░░░░░░                            26    ░░░░░░                         
   19    ░                                 27    ░                              
   20    ░░░░░░░                           28    ░░░░░░░                        
"
`;

exports[`syntaxHighlighted with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                 
    7    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    7    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
    8    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░    8    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
    9    ░░░░░░░░░░░░░░░░░░░░░              9    ░░░░░░░░░░░░░░░░░░░░░          
                                           10  + ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   10    ░░░░░░░░░░░░░░░░░░░░░░░░░░        11    ░░░░░░░░░░░░░░░░░░░░░░░░░░     
   11    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   12    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   12    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   13    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   13                                      14                                   
   14                                      15                                   
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                                                           
   20  + brew 'sonos'                                                           
   20    brew 'terminal-notifier'                                               
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                                                           
   43  - cask 'sonos'                                                           
   44    cask 'spotify'                                                         
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                                                           
   20  + brew 'sonos'                                                           
   20    brew 'terminal-notifier'                                               
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                                                           
   43  - cask 'sonos'                                                           
   44    cask 'spotify'                                                         
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -   [x] Organize code                                                  
   10  + -   [x] Move visual config to theme                                    
   10    -   [ ] Handle empty diffs                                             
   11                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Wed Apr 14 18:24:29 2021 -0700                                          
                                                                                
    test binary file addition                                                   
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                     
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                      
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                             
────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                     
    4  - このリポジトリは、MS-DOS ░░░░░░及び MS-DOS v2.0 のオリジナルのソースコード及びコンパイルされたバイナリを含んでいます
    4  + このリポジトリは、MS-DOS 及び MS-DOS v2.0 のオリジナルのソースコード及びコンパイルされたバイナリを含んでいます。
    5                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 14:35:42 2021 -0700                                          
                                                                                
    wip                                                                         
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                  
────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                 
    1  + node_modules/**                                                        
    2  + build/**                                                               
                                                                                
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 18 03:17:05 2021 -0700                                          
                                                                                
    Update main.yml                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■                                                                             
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                 
    1  - on run argv                                                            
    2  -     with timeout of 5 seconds                                          
    3  -         tell app "Terminal"                                            
    4  -             open "screenshots.sh"                                      
    5  -         end tell                                                       
    6  -     end timeout                                                        
    7  - end run                                                                
    8    No newline at end of file                                              
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 22:26:15 2021 -0700                                          
                                                                                
    Move sample diff files                                                      
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                        
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 4 19:04:26 2021 -0700                                           
                                                                                
    update lockfile                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                          
────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                     
    5  -         "revision": ░░░░                                               
    5  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░         
@@ -8 +8 @@                                                                     
    8  -         "revision": ░░░░                                               
    8  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░         
@@ -11 +11 @@                                                                   
   11  -         "revision": ░░░░                                               
   11  +         "revision": ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░         
@@ -16 +16 @@                                                                   
   16  -         "version": "1.░░.░░░",                                         
   16  +         "version": "1.░░.░",                                           
@@ -17,0 +18 @@                                                                 
   18  +           "rebuild": 0,                                                
@@ -19,0 +21 @@                                                                 
   21  +           "root_url": "https://homebrew.bintray.com/bottles",          
@@ -20,0 +23,8 @@                                                               
   23  +             "arm64_big_sur": {                                         
   24  +               "url": "https://homebrew.bintray.com/bottles/go-1.16.3.ar
   25  +               "sha256": "e7c1efdd09e951eb46d01a3200b01e7fa55ce285b75470
   26  +             },                                                         
   27  +             "big_sur": {                                               
   28  +               "url": "https://homebrew.bintray.com/bottles/go-1.16.3.bi
   29  +               "sha256": "ea37f33fd27369612a3e4e6db6adc46db0e8bdf6fac133
   30  +             },                                                         
@@ -22,2 +32,2 @@                                                               
   22  -               "url": "https://homebrew.bintray.com/bottles/go-1.░░.░░░.
   23  -               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   32  +               "url": "https://homebrew.bintray.com/bottles/go-1.░░.░.ca
   33  +               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
@@ -26,6 +36,2 @@                                                               
   26  -               "url": "https://homebrew.bintray.com/bottles/go-1.░░.░░░.
   27  -               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   28  -             },                                                         
   29  -             "high_sierra": {                                           
   30  -               "url": "https://homebrew.bintray.com/bottles/go-1.14.2_1.
   31  -               "sha256": "0997f6f5cda0e3bdb7789a80b53621cb588202ab37fd89
   36  +               "url": "https://homebrew.bintray.com/bottles/go-1.░░.░.mo
   37  +               "sha256": "░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
   32                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -        [x] Organize code                                             
   10  + -        [x] Move visual config to theme                               
   10    -        [ ] Handle empty diffs                                        
   11                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 11:53:02 2021 -0700                                          
                                                                                
    Organize code                                                               
                                                                                
commit f323143e03af95fee5d38c21238a92ffd4461847                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 10:39:17 2021 -0700                                          
                                                                                
    more todos                                                                  
                                                                                
"
`;

exports[`unifiedWithInlineChangesHighlighted diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  - This is file1                                                          
    2    No newline at end of file                                              
    2  + This is file1                                                          
    3  + Experimental change                                                    
────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  + All good                                                               
    1    This is file2                                                          
"
`;

exports[`unifiedWithInlineChangesHighlighted empty 1`] = `
"
"
`;

exports[`unifiedWithInlineChangesHighlighted merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                 
Merge: 2439767601 fbcdb8cf4f                                                    
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                        
Date:   Thu Dec 21 17:57:42 2023 -0800                                          
                                                                                
    Merge branch 'main' into gabritto/d2                                        
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                      
────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                            
  137        isBlock,                                                           
  138        isBlockOrCatchScoped,                                              
  139        IsBlockScopedContainer,                                            
  140  +     isBooleanLiteral,                                                  
  141        isCallExpression,                                                  
  142        isClassStaticBlockDeclaration,                                     
  143  +     isConditionalExpression,                                           
  144        isConditionalTypeNode,                                             
  145        IsContainer,                                                       
  146        isDeclaration,                                                     
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                       
────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                      
 6063        decoratorSignature?: Signature;     // Signature for decorator as i
 6064        spreadIndices?: { first: number | undefined, last: number | undefin
 6065        parameterInitializerContainsUndefined?: boolean; // True if this is
 6066  -     fakeScopeForSignatureDeclaration?: boolean; // True if this is a fa
 6066  +     contextualReturnType?: Type;        // If the node is a return stat
 6067  +     fakeScopeForSignatureDeclaration?: "params" | "typeParams"; // If p
 6068        assertionExpressionType?: Type;     // Cached type of the expressio
 6069    }                                                                      
"
`;

exports[`unifiedWithInlineChangesHighlighted merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                 
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                         
Author: Andy Hanson <anhans@microsoft.com>                                      
Date:   Thu Sep 1 12:52:42 2016 -0700                                           
                                                                                
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into c
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                    
────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                      
 2792            return node && node.parent && node.parent.kind === SyntaxKind.P
 2793        }                                                                  
 2794                                                                           
 2795  +     function climbPastPropertyAccess(node: Node) {                     
 2796  +         return isRightSideOfPropertyAccess(node) ? node.parent : node; 
 2797  +     }                                                                  
 2798  +                                                                        
 2799  -     function climbPastManyPropertyAccesses(node: Node): Node {         
 2800  -         return isRightSideOfPropertyAccess(node) ? climbPastManyPropert
 2799  +     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
 2800  +     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDecla
 2801  +         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
 2802  +     }                                                                  
 2803  +                                                                        
 2804        function isCallExpressionTarget(node: Node): boolean {             
 2805  -         if (isRightSideOfPropertyAccess(node)) {                       
 2806  -             node = node.parent;                                        
 2807  -         }                                                              
 2808  -         node = climbPastPropertyAccess(node);                          
 2809  -         return node && node.parent && node.parent.kind === SyntaxKind.C
 2805  +         return isCallOrNewExpressionTarget(node, SyntaxKind.CallExpress
 2806        }                                                                  
 2807                                                                           
 2808        function isNewExpressionTarget(node: Node): boolean {              
 2809  -         if (isRightSideOfPropertyAccess(node)) {                       
 2810  -             node = node.parent;                                        
 2811  -         }                                                              
 2812  -         node = climbPastPropertyAccess(node);                          
 2813  -         return node && node.parent && node.parent.kind === SyntaxKind.N
 2809  +         return isCallOrNewExpressionTarget(node, SyntaxKind.NewExpressi
 2810  +     }                                                                  
 2811  +                                                                        
 2812  +     function isCallOrNewExpressionTarget(node: Node, kind: SyntaxKind) 
 2813  +         const target = climbPastPropertyAccess(node);                  
 2814  +         return target && target.parent && target.parent.kind === kind &
 2815  +     }                                                                  
 2816  +                                                                        
 2817  -     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
 2818  -     function tryGetClassExtendingIdentifier(node: Node): ClassLikeDecla
 2819  -         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
 2817  +     function climbPastManyPropertyAccesses(node: Node): Node {         
 2818  +         return isRightSideOfPropertyAccess(node) ? climbPastManyPropert
 2819  +     }                                                                  
 2820  +                                                                        
 2821  +     /** Returns a CallLikeExpression where \`node\` is the target being i
 2822  +     function getAncestorCallLikeExpression(node: Node): CallLikeExpress
 2823  +         const target = climbPastManyPropertyAccesses(node);            
 2824  +         const callLike = target.parent;                                
 2825  +         return callLike && isCallLikeExpression(callLike) && getInvoked
 2826  +     }                                                                  
 2827  +                                                                        
 2828  +     function tryGetSignatureDeclaration(typeChecker: TypeChecker, node:
 2829  +         const callLike = getAncestorCallLikeExpression(node);          
 2830  +         return callLike && typeChecker.getResolvedSignature(callLike).d
 2831        }                                                                  
 2832                                                                           
 2833        function isNameOfModuleDeclaration(node: Node) {                   
 2834                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                
────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                 
    1    import chalk from 'chalk';                                             
    2    import * as process from 'process';                                    
    3  + import stream from 'stream';                                           
    3    import terminalSize from 'terminal-size';                              
    4    import { iterlinesFromReadableAsync } from './iterLinesFromReadable';  
    5    import { iterLinesWithoutAnsiColors } from './iterLinesWithoutAnsiColor
@@ -12,15 +13,16 @@ function main() {                                           
   12        const screenWidth = terminalSize().columns;                        
   13        const theme = defaultTheme(chalk, screenWidth);                    
   14                                                                           
   15  -     transformStreamWithIterables(                                      
   16  -         process.stdin,                                                 
   17  -         [                                                              
   16  +     stream.pipeline(                                                   
   17  +         transformStreamWithIterables(                                  
   18  +             process.stdin,                                             
   18                iterlinesFromReadableAsync,                                
   19                iterLinesWithoutAnsiColors,                                
   20                iterSideBySideDiff(theme),                                 
   21  -             iterWithNewlines░                                          
   22  -         ░,                                                             
   23  -         process.stdout                                                 
   22  +             iterWithNewlines                                           
   23  +         ░,                                                             
   24  +         process.stdout░                                                
   25  +         console.error                                                  
   24        );                                                                 
   25    }                                                                      
   26                                                                           
"
`;

exports[`unifiedWithInlineChangesHighlighted with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                 
    7    -   [x] Handle file addition/deletion properly                         
    8    -   [x] Fix incorrect line positions when a hunk has discontinuous inse
    9    -   [x] Organize code                                                  
   10  + -   [x] Move visual config to theme                                    
   10    -   [ ] Handle empty diffs                                             
   11    -   [ ] Handle moves and renames without diffs                         
   12    -   [ ] Highlight changes in lines                                     
   13                                                                           
   14                                                                           
"
`;

exports[`unifiedWithWrapping commit with a small diff 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                                                           
   20  + brew 'sonos'                                                           
   20    brew 'terminal-notifier'                                               
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                                                           
   43  - cask 'sonos'                                                           
   44    cask 'spotify'                                                         
"
`;

exports[`unifiedWithWrapping commit with a small diff without a/ and b/ prefixs 1`] = `
"
commit 26ca49fb83758bace20a473e231d576aa1bbe115                                 
Author: Shrey Banga <shrey@quip.com>                                            
Date:   Tue May 23 16:47:17 2017 -0700                                          
                                                                                
    sonos to brew                                                               
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile                                                                    
────────────────────────────────────────────────────────────────────────────────
@@ -19,2 +19,3 @@ brew 'python3'                                                
   19    brew 'socat'                                                           
   20  + brew 'sonos'                                                           
   20    brew 'terminal-notifier'                                               
@@ -42,3 +43,2 @@ cask 'rescuetime'                                             
   42    cask 'slate'                                                           
   43  - cask 'sonos'                                                           
   44    cask 'spotify'                                                         
"
`;

exports[`unifiedWithWrapping commit with addition 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -   [x] Organize code                                                  
   10  + -   [x] Move visual config to theme                                    
   10    -   [ ] Handle empty diffs                                             
   11                                                                           
"
`;

exports[`unifiedWithWrapping commit with binary file addition 1`] = `
"
commit c0ca4394fd55f1709430414f03db3d04cb9cc72c (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Wed Apr 14 18:24:29 2021 -0700                                          
                                                                                
    test binary file addition                                                   
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ screenshots/default.png                                                     
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ test dir a/default.png                                                      
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`unifiedWithWrapping commit with deletion 1`] = `
"commit eccfb5a2b3d76ba53df315f977da74b18d50113e
Author: Shrey Banga <shrey@quip.com>
Date:   Thu Aug 22 10:07:25 2019 -0700

    Remove deprecated option

diff --git a/Code/User/settings.json b/Code/User/settings.json
index a33d267..ae58a01 100644
--- a/Code/User/settings.json
+++ b/Code/User/settings.json
@@ -26,5 +26,4 @@
   // search
   "search.location": "panel",
-  "search.usePCRE2": true,

   // telemetry
"
`;

exports[`unifiedWithWrapping commit with double-spaced characters 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ README.ja-JP.md                                                             
────────────────────────────────────────────────────────────────────────────────
@@ -4 +4 @@                                                                     
    4  - このリポジトリは、MS-DOS v1.25 及び MS-DOS v2.0                        
         のオリジナルのソースコード及びコンパイルされたバイナリを含んでいます。 
                                                                                
    4  + このリポジトリは、MS-DOS 及び MS-DOS v2.0                              
         のオリジナルのソースコード及びコンパイルされたバイナリを含んでいます。 
                                                                                
    5                                                                           
"
`;

exports[`unifiedWithWrapping commit with file addition 1`] = `
"
commit e4951eee3b9a8fa471d01dd64075c5fd44879a26                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 14:35:42 2021 -0700                                          
                                                                                
    wip                                                                         
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ .gitignore                                                                  
────────────────────────────────────────────────────────────────────────────────
@@ -0,0 +1,2 @@                                                                 
    1  + node_modules/**                                                        
    2  + build/**                                                               
                                                                                
"
`;

exports[`unifiedWithWrapping commit with file deletion 1`] = `
"
commit 1e6ebaccc6fadf3390a749e7aa2cc6372b24325e                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 18 03:17:05 2021 -0700                                          
                                                                                
    Update main.yml                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■                                                                             
────────────────────────────────────────────────────────────────────────────────
────────────────────────────────────────────────────────────────────────────────
 ■■ scripts/screenshotTheme                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -1,7 +0,0 @@                                                                 
    1  - on run argv                                                            
    2  -     with timeout of 5 seconds                                          
    3  -         tell app "Terminal"                                            
    4  -             open "screenshots.sh"                                      
    5  -         end tell                                                       
    6  -     end timeout                                                        
    7  - end run                                                                
    8    No newline at end of file                                              
"
`;

exports[`unifiedWithWrapping commit with file move 1`] = `
"
commit 1c76ed4bb05429741fd4a48896bb84b11bc661f5                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sat Apr 10 22:26:15 2021 -0700                                          
                                                                                
    Move sample diff files                                                      
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ colors.diff -> test-data/colors.diff                                        
────────────────────────────────────────────────────────────────────────────────
"
`;

exports[`unifiedWithWrapping commit with inline line changes 1`] = `
"
commit 9e424d329800e945e3003c9e275f80bdef69e591                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 4 19:04:26 2021 -0700                                           
                                                                                
    update lockfile                                                             
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ Brewfile.lock.json                                                          
────────────────────────────────────────────────────────────────────────────────
@@ -5 +5 @@                                                                     
    5  -         "revision": null                                               
    5  +         "revision": "ee2f8d3ba2976e50ef577d517bf175c94fbbb0dd"         
@@ -8 +8 @@                                                                     
    8  -         "revision": null                                               
    8  +         "revision": "c4cf96857c050dfa4f65f52109862dc68e55f60a"         
@@ -11 +11 @@                                                                   
   11  -         "revision": null                                               
   11  +         "revision": "504d4b93aa6eaf4fce1bf17c19f55828ad7229a4"         
@@ -16 +16 @@                                                                   
   16  -         "version": "1.14.2_1",                                         
   16  +         "version": "1.16.3",                                           
@@ -17,0 +18 @@                                                                 
   18  +           "rebuild": 0,                                                
@@ -19,0 +21 @@                                                                 
   21  +           "root_url": "https://homebrew.bintray.com/bottles",          
@@ -20,0 +23,8 @@                                                               
   23  +             "arm64_big_sur": {                                         
   24  +               "url": "https://homebrew.bintray.com/bottles/go-1.16.3.ar
         m64_big_sur.bottle.tar.gz",                                            
   25  +               "sha256":                                                
         "e7c1efdd09e951eb46d01a3200b01e7fa55ce285b75470051be7fef34f4233ce"     
   26  +             },                                                         
   27  +             "big_sur": {                                               
   28  +               "url":                                                   
         "https://homebrew.bintray.com/bottles/go-1.16.3.big_sur.bottle.tar.gz",
   29  +               "sha256":                                                
         "ea37f33fd27369612a3e4e6db6adc46db0e8bdf6fac1332bf51bafaa66d43969"     
   30  +             },                                                         
@@ -22,2 +32,2 @@                                                               
   22  -               "url": "https://homebrew.bintray.com/bottles/go-1.14.2_1.
         catalina.bottle.tar.gz",                                               
   23  -               "sha256":                                                
         "15b5623471330edcc681d7f9d57b449660e6d4b98c7f67af67f4991fc75d61fc"     
   32  +               "url": "https://homebrew.bintray.com/bottles/go-1.16.3.ca
         talina.bottle.tar.gz",                                                 
   33  +               "sha256":                                                
         "69c28f5e60612801c66e51e93d32068f822b245ab83246cb6cb374572eb59e15"     
@@ -26,6 +36,2 @@                                                               
   26  -               "url": "https://homebrew.bintray.com/bottles/go-1.14.2_1.
         mojave.bottle.tar.gz",                                                 
   27  -               "sha256":                                                
         "fa65e7dabe514e65ae625ed3c84a6bf58df01aceffc6e9aa99752ca8c320ce69"     
   28  -             },                                                         
   29  -             "high_sierra": {                                           
   30  -               "url": "https://homebrew.bintray.com/bottles/go-1.14.2_1.
         high_sierra.bottle.tar.gz",                                            
   31  -               "sha256":                                                
         "0997f6f5cda0e3bdb7789a80b53621cb588202ab37fd89bcd269f8dfafd23351"     
   36  +               "url":                                                   
         "https://homebrew.bintray.com/bottles/go-1.16.3.mojave.bottle.tar.gz", 
   37  +               "sha256":                                                
         "bf1e90ed1680b8ee1acb49f2f99426c8a8ac3e49efd63c7f3b41e57e7214dd19"     
   32                                                                           
"
`;

exports[`unifiedWithWrapping commit with tabs 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -9,2 +9,3 @@                                                                 
    9    -        [x] Organize code                                             
   10  + -        [x] Move visual config to theme                               
   10    -        [ ] Handle empty diffs                                        
   11                                                                           
"
`;

exports[`unifiedWithWrapping commits without diffs 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717 (HEAD -> main)                  
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
commit b637f38029f4a89c6a3b73b2b84a6a5b9e260730                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 11:53:02 2021 -0700                                          
                                                                                
    Organize code                                                               
                                                                                
commit f323143e03af95fee5d38c21238a92ffd4461847                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 10:39:17 2021 -0700                                          
                                                                                
    more todos                                                                  
                                                                                
"
`;

exports[`unifiedWithWrapping diff from issue #50 1`] = `
"
────────────────────────────────────────────────────────────────────────────────
 ■■ file1                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  - This is file1                                                          
    2    No newline at end of file                                              
    2  + This is file1                                                          
    3  + Experimental change                                                    
────────────────────────────────────────────────────────────────────────────────
 ■■ file2                                                                       
────────────────────────────────────────────────────────────────────────────────
@@ -1 +1,2 @@                                                                   
    1  + All good                                                               
    1    This is file2                                                          
"
`;

exports[`unifiedWithWrapping empty 1`] = `
"
"
`;

exports[`unifiedWithWrapping merge commit with 2 parents 1`] = `
"
commit 3f504f4fbc1caf9c10814d48d8897a34f8a34dec                                 
Merge: 2439767601 fbcdb8cf4f                                                    
Author: Gabriela Araujo Britto <gabrielaa@microsoft.com>                        
Date:   Thu Dec 21 17:57:42 2023 -0800                                          
                                                                                
    Merge branch 'main' into gabritto/d2                                        
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/binder.ts                                                      
────────────────────────────────────────────────────────────────────────────────
@@@ -137,9 -136,9 +137,10 @@@ import                                            
  137        isBlock,                                                           
  138        isBlockOrCatchScoped,                                              
  139        IsBlockScopedContainer,                                            
  140  +     isBooleanLiteral,                                                  
  141        isCallExpression,                                                  
  142        isClassStaticBlockDeclaration,                                     
  143  +     isConditionalExpression,                                           
  144        isConditionalTypeNode,                                             
  145        IsContainer,                                                       
  146        isDeclaration,                                                     
────────────────────────────────────────────────────────────────────────────────
 ■■ src/compiler/types.ts                                                       
────────────────────────────────────────────────────────────────────────────────
@@@ -5985,8 -6063,7 +6063,8 @@@ export interface NodeLinks                      
 6063        decoratorSignature?: Signature;     // Signature for decorator as  
         if invoked by the runtime.                                             
 6064        spreadIndices?: { first: number | undefined, last: number |        
         undefined }; // Indices of first and last spread elements in array     
         literal                                                                
 6065        parameterInitializerContainsUndefined?: boolean; // True if this is
          a parameter declaration whose type annotation contains "undefined".   
 6066  -     fakeScopeForSignatureDeclaration?: boolean; // True if this is a   
         fake scope injected into an enclosing declaration chain.               
 6066  +     contextualReturnType?: Type;        // If the node is a return     
         statement's expression, then this is the contextual return type.       
 6067  +     fakeScopeForSignatureDeclaration?: "params" | "typeParams"; // If  
         present, this is a fake scope injected into an enclosing declaration   
         chain.                                                                 
 6068        assertionExpressionType?: Type;     // Cached type of the          
         expression of a type assertion                                         
 6069    }                                                                      
"
`;

exports[`unifiedWithWrapping merge commit with 3 parents 1`] = `
"
commit d6d6a4aedfa78794c1b611c13d2ed1d3a66e1798                                 
Merge: 0dc976df1e 5f16a48236 3eadbf6c96                                         
Author: Andy Hanson <anhans@microsoft.com>                                      
Date:   Thu Sep 1 12:52:42 2016 -0700                                           
                                                                                
    Merge branch 'goto_definition_super', remote-tracking branch 'origin' into  
constructor_references                                                          
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/services/services.ts                                                    
────────────────────────────────────────────────────────────────────────────────
@@@@ -2788,26 -2792,18 -2788,34 +2792,42 @@@@ namespace ts                      
 2792            return node && node.parent && node.parent.kind ===             
         SyntaxKind.PropertyAccessExpression &&                                 
         (<PropertyAccessExpression>node.parent).name === node;                 
 2793        }                                                                  
 2794                                                                           
 2795  +     function climbPastPropertyAccess(node: Node) {                     
 2796  +         return isRightSideOfPropertyAccess(node) ? node.parent : node; 
 2797  +     }                                                                  
 2798  +                                                                        
 2799  -     function climbPastManyPropertyAccesses(node: Node): Node {         
 2800  -         return isRightSideOfPropertyAccess(node) ?                     
         climbPastManyPropertyAccesses(node.parent) : node;                     
 2799  +     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
          or \`class C extends foo.N\` where \`N\` is an identifier. */             
 2800  +     function tryGetClassExtendingIdentifier(node: Node):               
         ClassLikeDeclaration | undefined {                                     
 2801  +         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
         tPropertyAccess(node).parent);                                         
 2802  +     }                                                                  
 2803  +                                                                        
 2804        function isCallExpressionTarget(node: Node): boolean {             
 2805  -         if (isRightSideOfPropertyAccess(node)) {                       
 2806  -             node = node.parent;                                        
 2807  -         }                                                              
 2808  -         node = climbPastPropertyAccess(node);                          
 2809  -         return node && node.parent && node.parent.kind ===             
         SyntaxKind.CallExpression && (<CallExpression>node.parent).expression  
         === node;                                                              
 2805  +         return isCallOrNewExpressionTarget(node,                       
         SyntaxKind.CallExpression);                                            
 2806        }                                                                  
 2807                                                                           
 2808        function isNewExpressionTarget(node: Node): boolean {              
 2809  -         if (isRightSideOfPropertyAccess(node)) {                       
 2810  -             node = node.parent;                                        
 2811  -         }                                                              
 2812  -         node = climbPastPropertyAccess(node);                          
 2813  -         return node && node.parent && node.parent.kind ===             
         SyntaxKind.NewExpression && (<CallExpression>node.parent).expression   
         === node;                                                              
 2809  +         return isCallOrNewExpressionTarget(node,                       
         SyntaxKind.NewExpression);                                             
 2810  +     }                                                                  
 2811  +                                                                        
 2812  +     function isCallOrNewExpressionTarget(node: Node, kind: SyntaxKind) 
         {                                                                      
 2813  +         const target = climbPastPropertyAccess(node);                  
 2814  +         return target && target.parent && target.parent.kind === kind  
         && (<CallExpression>target.parent).expression === target;              
 2815  +     }                                                                  
 2816  +                                                                        
 2817  -     /** Get \`C\` given \`N\` if \`N\` is in the position \`class C extends N\`
          or \`class C extends foo.N\` where \`N\` is an identifier. */             
 2818  -     function tryGetClassExtendingIdentifier(node: Node):               
         ClassLikeDeclaration | undefined {                                     
 2819  -         return tryGetClassExtendingExpressionWithTypeArguments(climbPas
         tPropertyAccess(node).parent);                                         
 2817  +     function climbPastManyPropertyAccesses(node: Node): Node {         
 2818  +         return isRightSideOfPropertyAccess(node) ?                     
         climbPastManyPropertyAccesses(node.parent) : node;                     
 2819  +     }                                                                  
 2820  +                                                                        
 2821  +     /** Returns a CallLikeExpression where \`node\` is the target being  
         invoked. */                                                            
 2822  +     function getAncestorCallLikeExpression(node: Node):                
         CallLikeExpression | undefined {                                       
 2823  +         const target = climbPastManyPropertyAccesses(node);            
 2824  +         const callLike = target.parent;                                
 2825  +         return callLike && isCallLikeExpression(callLike) &&           
         getInvokedExpression(callLike) === target && callLike;                 
 2826  +     }                                                                  
 2827  +                                                                        
 2828  +     function tryGetSignatureDeclaration(typeChecker: TypeChecker, node:
          Node): SignatureDeclaration | undefined {                             
 2829  +         const callLike = getAncestorCallLikeExpression(node);          
 2830  +         return callLike &&                                             
         typeChecker.getResolvedSignature(callLike).declaration;                
 2831        }                                                                  
 2832                                                                           
 2833        function isNameOfModuleDeclaration(node: Node) {                   
 2834                                                                           
"
`;

exports[`unifiedWithWrapping multiple inserts and deletes in the same hunk 1`] = `
"
commit e5f896655402f8cf2d947c528d45e1d56bbf5717                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 16:23:54 2021 -0700                                          
                                                                                
    Small refactor to allow testing end-to-end                                  
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ src/index.ts                                                                
────────────────────────────────────────────────────────────────────────────────
@@ -1,5 +1,6 @@                                                                 
    1    import chalk from 'chalk';                                             
    2    import * as process from 'process';                                    
    3  + import stream from 'stream';                                           
    3    import terminalSize from 'terminal-size';                              
    4    import { iterlinesFromReadableAsync } from './iterLinesFromReadable';  
    5    import { iterLinesWithoutAnsiColors } from                             
         './iterLinesWithoutAnsiColors';                                        
@@ -12,15 +13,16 @@ function main() {                                           
   12        const screenWidth = terminalSize().columns;                        
   13        const theme = defaultTheme(chalk, screenWidth);                    
   14                                                                           
   15  -     transformStreamWithIterables(                                      
   16  -         process.stdin,                                                 
   17  -         [                                                              
   16  +     stream.pipeline(                                                   
   17  +         transformStreamWithIterables(                                  
   18  +             process.stdin,                                             
   18                iterlinesFromReadableAsync,                                
   19                iterLinesWithoutAnsiColors,                                
   20                iterSideBySideDiff(theme),                                 
   21  -             iterWithNewlines,                                          
   22  -         ],                                                             
   23  -         process.stdout                                                 
   22  +             iterWithNewlines                                           
   23  +         ),                                                             
   24  +         process.stdout,                                                
   25  +         console.error                                                  
   24        );                                                                 
   25    }                                                                      
   26                                                                           
"
`;

exports[`unifiedWithWrapping with ANSI color codes 1`] = `
"
commit f735de7025c6d626c5ae1a291fe24f143dea0313                                 
Author: Shrey Banga <banga.shrey@gmail.com>                                     
Date:   Sun Apr 11 15:25:34 2021 -0700                                          
                                                                                
    Add theme support                                                           
                                                                                
────────────────────────────────────────────────────────────────────────────────
 ■■ todo.md                                                                     
────────────────────────────────────────────────────────────────────────────────
@@ -7,6 +7,7 @@                                                                 
    7    -   [x] Handle file addition/deletion properly                         
    8    -   [x] Fix incorrect line positions when a hunk has discontinuous     
         inserts and/or deletes                                                 
    9    -   [x] Organize code                                                  
   10  + -   [x] Move visual config to theme                                    
   10    -   [ ] Handle empty diffs                                             
   11    -   [ ] Handle moves and renames without diffs                         
   12    -   [ ] Highlight changes in lines                                     
   13                                                                           
   14                                                                           
"
`;
